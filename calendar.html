<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pickleball Bookings</title>
  <style>
    body{font-family:Arial,Helvetica,sans-serif;margin:18px;color:#111}
    h1{text-align:center}
    #controls{display:flex;justify-content:center;gap:12px;align-items:center;margin-bottom:12px;flex-wrap:wrap}
    input[type="date"]{padding:8px 10px;font-size:15px}
    button{padding:8px 10px;border-radius:6px;border:1px solid #888;background:#eee;cursor:pointer}
    table{width:100%;border-collapse:collapse;margin-top:12px}
    th,td{border:1px solid #ddd;padding:10px;text-align:center}
    th{background:#f4f4f4}
    .booked{background:#ffdddd;color:#b00;font-weight:700}
    .available{background:#ddffdd;color:#060;font-weight:700}
  </style>
</head>
<body>
  <h1>Pickleball Court â€” Reservation Calendar</h1>

  <div id="controls">
    <label for="datePicker"><strong>Select date:</strong></label>
    <input id="datePicker" type="date" />
    <button id="reloadBtn">Reload bookings</button>
  </div>

  <div id="calendar">Please pick a date.</div>
  <div id="error"></div>

<script>
(async ()=>{

  const dateInput = document.getElementById('datePicker');
  const calendarEl = document.getElementById('calendar');
  const errorEl = document.getElementById('error');
  const reloadBtn = document.getElementById('reloadBtn');

  const TIMES = ["08:00","09:00","10:00","11:00","12:00",
                 "13:00","14:00","15:00","16:00","17:00",
                 "18:00","19:00","20:00"];

  let bookingsMap = {};

  function normalizeTimeStr(t){
    if (!t) return null;
    t = String(t).trim();
    const m = t.match(/^(\d{1,2})(?::(\d{2}))?\s*([AaPp][Mm])?$/);
    if (m){
      let hh = Number(m[1]);
      const mm = Number(m[2] ?? 0);
      const ap = m[3] ? m[3].toUpperCase() : null;
      if (ap === 'PM' && hh !== 12) hh += 12;
